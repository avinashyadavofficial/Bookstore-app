<app-topbar></app-topbar>

<div class="cart-wrapper">
  <div class="cartbox">
  <h3>My cart ({{ cartItems.length }})</h3>

  <div *ngFor="let item of cartItems" class="cart-item-card">
    <img [src]="item.product_id.bookImage || '/book.png'" alt="Book" class="book-img" />

    <div class="book-details">
      <h4>{{ item.product_id.bookName }}</h4>
      <p>by {{ item.product_id.author }}</p>
      <div class="price">
        Rs. {{ item.product_id.discountPrice }}
        <span class="strike">Rs. {{ item.product_id.price }}</span>
      </div>

      <div class="qty-actions">
        <button (click)="changeQty(item, item.quantityToBuy - 1)">−</button>
        <span>{{ item.quantityToBuy }}</span>
        <button (click)="changeQty(item, item.quantityToBuy + 1)">+</button>
        <span class="remove" (click)="removeItem(item._id)">Remove</span>
      </div>
    </div>
  </div>
  

  <div class="cart-footer" *ngIf="!showAddressSection">
    <button (click)="placeOrderClicked()">PLACE ORDER</button>
  </div>
</div>
  <!-- Address Box -->
  <div class="step-box">
    <div class="step-header">Address Details</div>
    <div *ngIf="showAddressSection" class="step-body">
      <h3>Customer Details</h3>

      <div class="form-row">
        <input type="text" placeholder="Full Name" [(ngModel)]="userDetails.fullName"  disabled=""/>
        <input type="text" placeholder="Mobile Number" [(ngModel)]="userDetails.phone" disabled/>
      </div>

      <div class="form-row">
        <select [(ngModel)]="userDetails.addressType">
          <option disabled check>Home</option>
          <option disabled>Work</option>
        </select>
      </div>

      <textarea rows="3" placeholder="Full Address" [(ngModel)]="userDetails.fullAddress" disabled></textarea>

      <div class="form-row">
        <input type="text" placeholder="City/Town" [(ngModel)]="userDetails.city" disabled />
        <input type="text" placeholder="State" [(ngModel)]="userDetails.state"  disabled/>
      </div>

      <button *ngIf="!showOrderSummarySection" (click)="continueClicked()">CONTINUE</button>
    </div>
  </div>

  <!-- Order Summary -->
  <div class="step-box">
    <div class="step-header">Order summary</div>
    <div *ngIf="showOrderSummarySection" class="step-body">
      <div *ngFor="let item of cartItems" class="summary-card">
        <img [src]="item.product_id.bookImage || '/book.png'" alt="Book" class="summary-img" />
        <div class="summary-details">
          <h4>{{ item.product_id.bookName }}</h4>
          <p>by {{ item.product_id.author }}</p>
          <div class="summary-price">
            Rs. {{ item.product_id.discountPrice }} × {{ item.quantityToBuy }} =
            <strong>Rs. {{ item.product_id.discountPrice * item.quantityToBuy }}</strong>
          </div>
        </div>
      </div>

      <div class="summary-total">
        Grand Total: <strong>Rs. {{ grandTotal }}</strong>
      </div>

      <button (click)="checkout()">CHECKOUT</button>
    </div>
  </div>
</div>

<app-footer></app-footer>
